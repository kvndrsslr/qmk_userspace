#include QMK_KEYBOARD_H
#include "version.h"

enum unicode_names {
    AU,
    AAU,
    OU,
    OOU,
    UU,
    UUU,
    SZ,
    SSZ
};

const uint32_t PROGMEM unicode_map[] = {
    [AU]  = 0x00e4,
    [AAU] = 0x00c4,
    [OU]  = 0x00f6,
    [OOU] = 0x00d6,
    [UU]  = 0x00fc,
    [UUU] = 0x00dc,
    [SZ]  = 0x00df,
    [SSZ] = 0x1e9e
};

#define MUC_SZ   UP(SZ, SSZ)
#define MUC_AUML UP(AU, AAU)
#define MUC_OUML UP(OU, OOU)
#define MUC_UUML UP(UU, UUU)

#define MTEAMS LSFT(LCA(KC_M))

enum layers {
    UBSE,
    USYM,
    UGER,
    UFNK,
    GAME,
    BASE,  // default layer
    SYMB,  // symbols
    MDIA,  // media keys
};

enum custom_keycodes {
    VRSN = SAFE_RANGE,
};

#define LAYOUT_moonlander_wrapper(...)   LAYOUT_moonlander(__VA_ARGS__)

// clang-format off
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
/* .---------------------------------------------. .---------------------------------------------.
 * |__VA_AR|     |     |     |     |     |       | !       |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |       | !       |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |       ! !       |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |                 |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |                             |     |     |     |     |       |
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |               | !               |
 *                       .-------+---------------! !---------------+-------.
 *                       !       !       |       | !       |       !       !
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [UBSE] = LAYOUT_moonlander_wrapper(
      KC_EQUAL,       KC_1,           KC_2,           KC_3,           KC_4,           KC_5,           MO(SYMB) ,                                          MTEAMS       , KC_6,           KC_7,           KC_8,           KC_9,           KC_0,           KC_MINUS,
    KC_ESCAPE,      KC_Q,           KC_W,           KC_E,           KC_R,           KC_T,           MO(UFNK),                                          MO(UFNK),          KC_Y,           KC_U,           KC_I,           KC_O,           KC_P,           KC_ESCAPE,
    KC_BACKSPACE,      LSFT_T(KC_A),           LALT_T(KC_S),   LCTL_T(KC_D),   LGUI_T(KC_F),   LT(UGER,KC_G), MO(USYM),                                          MO(USYM),   LT(UGER,KC_H),     RGUI_T(KC_J),   RCTL_T(KC_K),   RALT_T(KC_L),   RSFT_T(KC_SEMICOLON),      KC_DELETE,
    KC_LSFT,      KC_Z,           KC_X,           KC_C,           KC_V,           KC_B,                                                             KC_N,           KC_M,           KC_COMMA,       KC_DOT,         KC_SLASH,       KC_RSFT,
    OSM(MOD_HYPR),  OSM(MOD_MEH),   KC_BACKSLASH,      KC_GRAVE,       SH_T(KC_QUOTE),                LGUI(KC_SPACE),                                       LGUI(KC_SPACE),         KC_LEFT_BRACKET,    KC_RIGHT_BRACKET,    _______       , OSM(MOD_MEH),   OSM(MOD_HYPR),
                                                                                    LT(USYM,KC_SPACE),       KC_TAB,         _______       ,          QK_BOOT,          KC_TAB,         KC_ENTER
    ),
/* .---------------------------------------------. .---------------------------------------------.
 * | VRSN  |     |     |     |     |     |       | !       |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |       | !       |MS_WH|MS_WH|MS_WH|MS_WH|     |       |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |       ! !       |LEFT |DOWN | UP  |RIGHT|MS_BT|       |
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |                 |MS_LE|MS_DO|MS_UP|MS_RI|     |       |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |                             |MEDIA|MEDIA|MEDIA|MEDIA|       |
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |               | !               |
 *                       .-------+---------------! !---------------+-------.
 *                       !       !       |       | !QK_MAKE|MS_BTN2!MS_BTN1!
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [USYM] = LAYOUT_moonlander(
       VRSN,       _______       ,           _______       ,           _______       ,           _______       ,           _______       ,           _______       ,                                 _______       , _______       , _______       , _______       , _______       , _______       , _______       ,
    _______       , _______       ,           _______       ,           _______       ,           _______       ,           _______       ,           _______       ,                                 _______       , KC_MS_WH_LEFT,  KC_MS_WH_DOWN,  KC_MS_WH_UP,    KC_MS_WH_RIGHT, _______       , _______       ,
    _______       ,      _______       ,      _______       ,   _______       ,  _______       ,   _______       ,      _______       ,                                                      _______       ,            KC_LEFT,        KC_DOWN,        KC_UP,          KC_RIGHT,       KC_MS_BTN3,     _______       ,
    _______       , _______       , _______       , _______       ,   _______       ,      _______       ,                                         KC_MS_LEFT,     KC_MS_DOWN,     KC_MS_UP,       KC_MS_RIGHT,    _______       , _______       ,
    _______       , _______       , _______       , _______       ,    _______       ,    _______       ,                                                                                      _______       ,   KC_MEDIA_PREV_TRACK,KC_MEDIA_PLAY_PAUSE,KC_MEDIA_STOP,  KC_MEDIA_NEXT_TRACK,_______       ,
                                                                                    _______       , _______       , _______       , QK_MAKE,          KC_MS_BTN2,     KC_MS_BTN1
    ),
/* .---------------------------------------------. .---------------------------------------------.
 * |       |     |     |     |     |     |       | !       |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |       | !       |     |MUC_U|     |MUC_O|     |       |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |MUC_A|MUC_S|     |     |     |       ! !       |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |                 |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |                             |     |     |     |     |       |
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |               | !               |
 *                       .-------+---------------! !---------------+-------.
 *                       !       !       |       | !       |       !       !
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [UGER] = LAYOUT_moonlander(
    _______       , _______       , _______       , _______       , _______       , _______       , _______       ,                                 _______       , _______       , _______       , _______       , _______       , _______       , _______       ,
    _______       , _______       , _______       , _______       , _______       , _______       , _______       ,                                 _______       , _______       , MUC_UUML,       _______       , MUC_OUML,       _______       , _______       ,
    _______       , MUC_AUML,       MUC_SZ,         _______       , _______       , _______       ,     _______       ,                                                 _______       ,         _______       , _______       , _______       , _______       , _______       , _______       ,
    _______       , _______       , _______       , _______       , _______       , _______       ,                              _______       , _______       , _______       , _______       , _______       , _______       ,
    _______       , _______       , _______       , _______       , _______       ,  _______      ,                                _______       ,      _______       , _______       , _______       , _______       , _______       ,
                                                                                    _______       , _______       , _______       , _______       , _______       , _______
    ),
/* .---------------------------------------------. .---------------------------------------------.
 * |       | F1  | F2  | F3  | F4  | F5  |       | !       | F6  | F7  | F8  | F9  | F10 |  F11  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |       | !       |     |  7  |  8  |  9  |     |  F12  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |       ! !       |     |  4  |  5  |  6  |     |       |
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |                 |     |  1  |  2  |  3  |     |       |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |                             |     |  0  |     |     |       |
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |   LED_LEVEL   | !               |
 *                       .-------+---------------! !---------------+-------.
 *                       !       !       |       | !       |       !       !
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [UFNK] = LAYOUT_moonlander(
    _______       , KC_F1,          KC_F2,          KC_F3,          KC_F4,          KC_F5,          _______       ,                                 _______       , KC_F6,          KC_F7,          KC_F8,          KC_F9,          KC_F10,         KC_F11,
    _______       , _______       , _______       , _______       , _______       , _______       , _______       ,                                 _______       , _______       , KC_7,           KC_8,           KC_9,           _______       , KC_F12,
    _______       , _______       , _______       , _______       , _______       , _______       , _______       ,                                 _______       , _______       , KC_4,           KC_5,           KC_6,           _______       , _______       ,
    _______       , _______       , _______       , _______       , _______       , _______       ,                                                                 _______       , KC_1,           KC_2,           KC_3,           _______       , _______       ,
    _______       , _______       , _______       , _______       , _______       , LED_LEVEL     ,                                                                 _______       ,   _______       , KC_0,           _______       , _______       , _______       ,
                                                                                    _______       , _______       , _______       , _______       , _______       , _______
    ),
/* .---------------------------------------------. .---------------------------------------------.
 * |  EQL  |  1  |  2  |  3  |  4  |  5  | LEFT  | ! RGHT  |  6  |  7  |  8  |  9  |  0  | MINS  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |  DEL  |  Q  |  W  |  E  |  R  |  T  |TG(SYMB| !TG(SYMB|  Y  |  U  |  I  |  O  |  P  | BSLS  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * | BSPC  |  A  |  S  |  D  |  F  |  G  | HYPR  ! !  MEH  |  H  |  J  |  K  |  L  |LT(MD|LGUI_T(|
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * | LSFT  |LCTL_|  X  |  C  |  V  |  B  |                 |  N  |  M  |COMM | DOT |RCTL_| RSFT  |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |LT(SYMB|WEBUS|A(KC_|LEFT |RGHT |                             | UP  |DOWN |LBRC |RBRC |MO(SYMB|
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |LALT_T(KC_APP) | !RCTL_T(KC_ESC) |
 *                       .-------+---------------! !---------------+-------.
 *                       !  SPC  ! BSPC  | LGUI  | ! LALT  |  TAB  !  ENT  !
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [GAME] = LAYOUT_moonlander(
        KC_EQL,  KC_1,    KC_2,    KC_3,    KC_4,    KC_5,    KC_LEFT,           KC_RGHT, KC_6,    KC_7,    KC_8,    KC_9,    KC_0,    KC_MINS,
        KC_DEL,  KC_Q,    KC_W,    KC_E,    KC_R,    KC_T,    TG(SYMB),         TG(SYMB), KC_Y,    KC_U,    KC_I,    KC_O,    KC_P,    KC_BSLS,
        KC_BSPC, KC_A,    KC_S,    KC_D,    KC_F,    KC_G,    KC_HYPR,           KC_MEH,  KC_H,    KC_J,    KC_K,    KC_L,    LT(MDIA, KC_SCLN), LGUI_T(KC_QUOT),
        KC_LSFT, LCTL_T(KC_Z),KC_X,KC_C,    KC_V,    KC_B,                                KC_N,    KC_M,    KC_COMM, KC_DOT,  RCTL_T(KC_SLSH), KC_RSFT,
    LT(SYMB,KC_GRV),WEBUSB_PAIR,A(KC_LSFT),KC_LEFT, KC_RGHT,  LALT_T(KC_APP),    RCTL_T(KC_ESC),   KC_UP,   KC_DOWN, KC_LBRC, KC_RBRC, MO(SYMB),
                                            KC_SPC,  KC_BSPC, KC_LGUI,           KC_LALT,  KC_TAB,  KC_ENT
    ),
/* .---------------------------------------------. .---------------------------------------------.
 * |  EQL  |  1  |  2  |  3  |  4  |  5  | LEFT  | ! RGHT  |  6  |  7  |  8  |  9  |  0  | MINS  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |  DEL  |  Q  |  W  |  E  |  R  |  T  |TG(SYMB| !TG(SYMB|  Y  |  U  |  I  |  O  |  P  | BSLS  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * | BSPC  |  A  |  S  |  D  |  F  |  G  | HYPR  ! !  MEH  |  H  |  J  |  K  |  L  |LT(MD|LGUI_T(|
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * | LSFT  |LCTL_|  X  |  C  |  V  |  B  |                 |  N  |  M  |COMM | DOT |RCTL_| RSFT  |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |LT(SYMB|WEBUS|A(KC_|LEFT |RGHT |                             | UP  |DOWN |LBRC |RBRC |MO(SYMB|
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |LALT_T(KC_APP) | !RCTL_T(KC_ESC) |
 *                       .-------+---------------! !---------------+-------.
 *                       !  SPC  ! BSPC  | LGUI  | ! LALT  |  TAB  !  ENT  !
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [BASE] = LAYOUT_moonlander(
        KC_EQL,  KC_1,    KC_2,    KC_3,    KC_4,    KC_5,    KC_LEFT,           KC_RGHT, KC_6,    KC_7,    KC_8,    KC_9,    KC_0,    KC_MINS,
        KC_DEL,  KC_Q,    KC_W,    KC_E,    KC_R,    KC_T,    TG(SYMB),         TG(SYMB), KC_Y,    KC_U,    KC_I,    KC_O,    KC_P,    KC_BSLS,
        KC_BSPC, KC_A,    KC_S,    KC_D,    KC_F,    KC_G,    KC_HYPR,           KC_MEH,  KC_H,    KC_J,    KC_K,    KC_L,    LT(MDIA, KC_SCLN), LGUI_T(KC_QUOT),
        KC_LSFT, LCTL_T(KC_Z),KC_X,KC_C,    KC_V,    KC_B,                                KC_N,    KC_M,    KC_COMM, KC_DOT,  RCTL_T(KC_SLSH), KC_RSFT,
    LT(SYMB,KC_GRV),WEBUSB_PAIR,A(KC_LSFT),KC_LEFT, KC_RGHT,  LALT_T(KC_APP),    RCTL_T(KC_ESC),   KC_UP,   KC_DOWN, KC_LBRC, KC_RBRC, MO(SYMB),
                                            KC_SPC,  KC_BSPC, KC_LGUI,           KC_LALT,  KC_TAB,  KC_ENT
    ),
/* .---------------------------------------------. .---------------------------------------------.
 * | VRSN  | F1  | F2  | F3  | F4  | F5  |       | !       | F6  | F7  | F8  | F9  | F10 |  F11  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |EXLM | AT  |LCBR |RCBR |PIPE |       | !       | UP  |  7  |  8  |  9  |ASTR |  F12  |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |HASH | DLR |LPRN |RPRN | GRV |       ! !       |DOWN |  4  |  5  |  6  |PLUS |       |
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * |       |PERC |CIRC |LBRC |RBRC |TILD |                 |AMPR |  1  |  2  |  3  |BSLS |       |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |EE_CLR |     |     |     |     |                             |     | DOT |  0  | EQL |       |
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |    RGB_MOD    | !    RGB_TOG    |
 *                       .-------+---------------! !---------------+-------.
 *                       !RGB_VAD!RGB_VAI|TOGGLE_| !       |RGB_HUD!RGB_HUI!
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [SYMB] = LAYOUT_moonlander(
        VRSN,    KC_F1,   KC_F2,   KC_F3,   KC_F4,   KC_F5,   _______,           _______, KC_F6,   KC_F7,   KC_F8,   KC_F9,   KC_F10,  KC_F11,
        _______, KC_EXLM, KC_AT,   KC_LCBR, KC_RCBR, KC_PIPE, _______,           _______, KC_UP,   KC_7,    KC_8,    KC_9,    KC_ASTR, KC_F12,
        _______, KC_HASH, KC_DLR,  KC_LPRN, KC_RPRN, KC_GRV,  _______,           _______, KC_DOWN, KC_4,    KC_5,    KC_6,    KC_PLUS, _______,
        _______, KC_PERC, KC_CIRC, KC_LBRC, KC_RBRC, KC_TILD,                             KC_AMPR, KC_1,    KC_2,    KC_3,    KC_BSLS, _______,
        EE_CLR,  _______, _______, _______, _______,          RGB_MOD,           RGB_TOG,          _______, KC_DOT,  KC_0,    KC_EQL,  _______,
                                            RGB_VAD, RGB_VAI, TOGGLE_LAYER_COLOR,_______, RGB_HUD, RGB_HUI
    ),
/* .---------------------------------------------. .---------------------------------------------.
 * |LED_LEV|     |     |     |     |     |       | !       |     |     |     |     |     |QK_BOOT|
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |MS_U |     |     |       | !       |     |     |     |     |     |       |
 * !-------+-----+-----+-----+-----+-----+-------! !-------+-----+-----+-----+-----+-----+-------!
 * |       |     |MS_L |MS_D |MS_R |     |       ! !       |     |     |     |     |     | MPLY  |
 * !-------+-----+-----+-----+-----+-----+-------' '-------+-----+-----+-----+-----+-----+-------!
 * |       |     |     |     |     |     |                 |     |     |MPRV |MNXT |     |       |
 * !-------+-----+-----+-----+-----+-----'                 '-----+-----+-----+-----+-----+-------!
 * |       |     |     |BTN1 |BTN2 |                             |VOLU |VOLD |MUTE |     |       |
 * '-------------------------------'                             '-------------------------------'
 *                               .---------------. .---------------.
 *                               |               | !               |
 *                       .-------+---------------! !---------------+-------.
 *                       !       !       |       | !       |       !       !
 *                       '-----------------------' '-----------------------'
 *                                                                      generated by [keymapviz] */
    [MDIA] = LAYOUT_moonlander(
        LED_LEVEL,_______,_______, _______, _______, _______, _______,           _______, _______, _______, _______, _______, _______, QK_BOOT,
        _______, _______, _______, KC_MS_U, _______, _______, _______,           _______, _______, _______, _______, _______, _______, _______,
        _______, _______, KC_MS_L, KC_MS_D, KC_MS_R, _______, _______,           _______, _______, _______, _______, _______, _______, KC_MPLY,
        _______, _______, _______, _______, _______, _______,                             _______, _______, KC_MPRV, KC_MNXT, _______, _______,
        _______, _______, _______, KC_BTN1, KC_BTN2,         _______,            _______,          KC_VOLU, KC_VOLD, KC_MUTE, _______, _______,
                                            _______, _______, _______,           _______, _______, _______
    ),
};

bool process_record_user(uint16_t keycode, keyrecord_t *record) {
    if (record->event.pressed) {
        switch (keycode) {
        case VRSN:
            SEND_STRING (QMK_KEYBOARD "/" QMK_KEYMAP " @ " QMK_VERSION);
            return false;
        }
    }
    return true;
}
